<!DOCTYPE html>
<html>
<head>
	<title>darwin</title>

	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
	<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>
</head>
<body>

<div data-role="page">
	<div data-role="header">
		<h1>darwin</h1>
	</div><!-- /header -->
	<div data-role="content">
        <button id="up">UP</button>
        <button id="down">DOWN</button>
	</div><!-- /content -->
	<div data-role="footer" data-position="fixed">
		<h4>by <a href="http://github.com/devNil/">devNil</a></h4>
	</div><!-- /footer -->
</div><!-- /page -->
<script type="application/javascript">
        var addr = {{.Url}};
        var id = "{{.Id}}";
        
        var conn = new WebSocket("ws://"+addr+"/wsm");
        
        conn.onopen = function(){
            conn.send(id); 
        };
    
        conn.onclose = function(evt) {
            console.log("closed");
        };
        
        conn.onmessage = function(event){
            console.log(event.data);
        };
        
        var up = function(){
            conn.send("Up");  
        };
    
        var down = function(){
            conn.send("Down")
        }
    
        $(window).bind("beforeunload",function(){
            conn.send("Close");
            conn.close();
        });
    
        document.getElementById("up").onclick = up;
        document.getElementById("up").ontouch = up;
        document.getElementById("down").onclick = down;
        document.getElementById("down").ontouch = down;
    </script>
</body>
</html>